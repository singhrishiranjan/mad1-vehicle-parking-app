<!DOCTYPE html>
<html>
    <head>
        <title>Dashboard</title>
    </head>
    <body>
        <h2>Welcome, {{ user.email }}!</h2>
        Here is your Dashboard. <br>
        
        <p>
            <h4>Reserve a spot for Parking</h4>
            <form id="spot_search" action = "{{url_for('search')}}" method="GET">
                <input type = "text" id = "search" placeholder="Location/Pincode/Area" name = "query" required> 
                <input type = "submit" value = "Search">
            </form>
        </p>
            {% if results is defined %}
                <table>
                    <thead>
                        <tr>
                            <th>Prime Location</th>
                            <th>Address</th>
                            <th>Pincode</th>
                            <th>Spot No.</th>
                            <th>Vehicle Type</th>
                            <th>Cost per hour</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if results %}
                            {% for result in results %}
                            <tr>
                                <td>{{ result.lot.prime_location_name }}</td>
                                <td>{{ result.lot.address }}</td>
                                <td>{{ result.lot.pincode }}</td>
                                <td>{{ result.spot_number }}</td>
                                <td>{{ result.vehicle_type }}</td>
                                <td>{{ result.price_per_hour }}</td>
                                <td><form method="POST" action="{{ url_for('booking_confirmation') }}">
                                        <input type="hidden" name="spot_id" value="{{ result.id }}">
                                        <button type="submit">Book</button>
                                    </form></td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr><td colspan="6">No results found</td></tr>
                        {% endif %}
                    </tbody>
                </table>
            {% endif %}

        
        <a href="{{ url_for('logout') }}">Logout</a>
    </body>
</html>